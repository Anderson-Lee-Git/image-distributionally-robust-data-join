\documentclass{article}

\usepackage{latexsym}
\usepackage{bbm}
\usepackage[small,bf]{caption2}
\usepackage{graphics}
\usepackage{epsfig}
\usepackage{amsmath,amssymb,amsthm,amsfonts}
\usepackage{url}
\usepackage{hyperref}
\usepackage{enumerate}

\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows}

%% Page size
\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}
\setlength{\textwidth}{6.5in}
\setlength{\topmargin}{0in}
\setlength{\textheight}{8.5in}

% Footnote commands.
\newcommand{\footnotenonumber}[1]{{\def\thempfn{}\footnotetext{#1}}}
\newcommand{\footnotetight}[1]{\footnote{\renewcommand\baselinestretch{1}\footnotesize #1}}

\newtheorem{propo}{Proposition}[section]
\newtheorem{lemma}[propo]{Lemma}
\newtheorem{definition}[propo]{Definition}
\newtheorem{coro}[propo]{Corollary}
\newtheorem{thm}[propo]{Theorem}
\newtheorem{conj}[propo]{Conjecture}
\newtheorem{fact}[propo]{Fact}
\newtheorem{remark}[propo]{Remark}
\newtheorem{claim}[propo]{Claim}

\newcommand{\T}{{\sf T}}
\newcommand{\Tk}{{\mathbb T_k^{\phi}}}
\newcommand{\Tl}{{\sf T(\ell)}}
\newcommand{\uH}{{\underbar{H}}}
\newcommand{\mulH}{{ \mu^{\ell,H}}}
\newcommand{\dTl}{{ \partial \T(\ell)}}
\newcommand{\bE}{\mathbb{E}}
\newcommand{\prob}{\mathbb{P}}
\newcommand{\IS}{{\rm IS}}
\newcommand{\ind}{\mathbb{I}}
\newcommand{\naturals}{\mathbb{N}}
\def\vE{\vec{E}}
\def\reals{\mathbb R}
\def\tp{\tilde{p}}
\def\hx{\hat{x}}
\def\cX{{\cal X}}
\def\cN{{\cal N}}
\def\hx{\widehat{x}}
\def\hs{\widehat{s}}
\def\hz{\widehat{z}}
\def\<{\langle}
\def\>{\rangle}
\def\cN{{\cal N}}
\def\Cost{{\cal C}}

\def\meas{{\sf M}}
\def\vE{{\vec{E}}}
\def\F{{\sf F}}
\def\Fv{{\sf F^v}}
\def\hT{\widehat{T}}
\def\cE{{\cal E}}
\def\Tmix{T_{\rm mix}}
\def\ones{\mathds 1}
\def\dBall{\partial{\sf B}}
\def\SAW{\mbox{\tiny SAW}}
\def\pe{P_{\rm error}}
\def\tnu{\tilde{\nu}}
\def\IS{{\rm IS}}
\def\ind{{\mathbb I}}
\def\reals{{\mathbb R}}
\def\naturals{{\mathbb N}}
\def\root{\o}
\def\vE{\vec{E}}
\def\te{\theta_{\rm e}}
\def\tv{\theta_{\rm v}}
\def\be{b_{\rm e}}
\def\bv{b_{\rm v}}
\def\Bethe{{\mathbb F}}
\def\E{{\mathbb E}}
\def\prob{{\mathbb P}}
\def\hs{{\hat t}}
\def\htt{{\hat t}}
\def\hw{{\hat w}}
\def\E{{\mathbb E}}
\def\sign{{\rm sign}}
\def\BP{{\bf P}}
\def\pvar{{q}}
\def\pmean{{\alpha}}
\def\reals{{\mathbb{R}}}
\def\cX{{\cal X}}
\def\cY{{\cal Y}}
\def\cZ{{\cal Z}}
\def\hx{{\hat x}}
\def\da{{\partial a}}
\def\di{{\partial i}}
\def\ind{{\mathbb I}}
\def\deg{{\rm deg}}
\def\tA{{\widetilde A}}
\def\cI{{\cal I}}
\def\cC{{\cal C}}
\def\cC{{\cal C}}
\def\cG{{\cal G}}
\def\normeq{{\propto}}
\def\tol{\leftarrow}
\def\normal{{\rm N}}
\def\root{{o}}
\def\tmu{{\tilde \mu}}
\def\id{{\mathbb I}}
\def\cN{{\cal N}}
\def\hh{\hat{h}}
\def\hJ{\hat{J}}
\def\bone{{\bf 1}}
\def\bx{\overline{x}}
\def\Lap{{\cal L}}
\def\BP{{\sc\rm BP}}
\def\CTree{{\sf CT}_G}
\def\cL{{\cal L}}
\def\Gibbs{{\mathbb G}}
\def\Bethe{{\mathbb F}}
\def\TRW{{\mathbb F}_{\mbox{\tiny TRW}}}
\def\MARG{{\rm MARG}}
\def\cR{{\cal \bf R}}
\def\cT{{\cal T}}
\def\LOC{{\rm LOC}}
\def\Cov{{\rm Cov}}
\def\Var{{\rm Var}}
\def\conv{{\rm conv}}
\def\cR{{\cal \bf R}}
\def\det{{\rm det}}
\def\by{\overline{y}}

\def\rank{{\rm rank}}
\def\<{\langle}
\def\>{\rangle}
\def\tX{\widetilde{X}}
\def\tx{\widetilde{x}}
\def\hx{\widehat{x}}

\def\de{\text{d}}
\def\deg{\text{deg}}
\def\ind{{\mathbb I}}
\def\ve{\varepsilon}
\def\eps{\epsilon}
\def\M{{\sf M}} 
\def\N{{\sf N}} 
\def\Z{{\sf Z}} 
\def\V{{\sf V}} 
\def\U{{\sf U}} 
\def\hM{\hat{\sf M}} 
\def\E{{\mathbb E}}
\def\te{\tilde{\epsilon}}
\def\reals{\mathbb{R}}

\def\tM{\widetilde{\sf M}}
\def\tN{\widetilde{\sf N}}
\def\de{\text{d}}
\def\ux{\underline{x}}
\def\uy{\underline{y}}
\def\uz{\underline{z}}
\def\us{\underline{s}}
\def\ind{{\mathbb I}}
\def\cX{{\cal X}}
\def\cY{{\cal Y}}
\def\me{{\nu}}
\def\diam{{\rm diam}}
\def\sTV{\mbox{\tiny TV}}
\def\ve{\varepsilon}
\def\di{\partial i}
\def\T{{\rm T}}
\def\Ball{{\sf B}}
\def\M{{\sf M}} 
\def\normeq{{\cong}}
\def\atanh{\text{atanh}}
\def\P{{\sf P}}
\def\prob{{\mathbb P}}
\def\F{{\sf F}}
\def\H{{\mathbb H}}
\def\uX{\underline{X}}
\def\cD{{\cal D}}
\def\f{{\mathfrak f}}
\def\E{{\mathbb E}}
\def\me{\nu}
\def\mh{\widehat{\nu}}
\def\naturals{{\mathbb N}}
\def\rationals{{\mathbb Q}}
\def\da{{\partial a}}
\def\perr{{\rm P}_{\rm err}}
\def\Em{{\rm E}_{\rm m}}
\def\Xh{\widehat{X}}
\def\eps{\epsilon}
\def\hm{\hat{m}}

\def\vv{\vec{v}}
\def\vu{\vec{u}}
\def\uv{\underline{v}}
\def\uu{\underline{u}}
\def\reals{\mathbb{R}}
\def\RMSE{{\sf RMSE}}
\def\cF{{\cal F}}
\def\cP{{\mathcal P}}
\def\id{{\mathbf 1}}
%\def\Z{\mathbb{Z}}
\def\xm{{\bf x}}
\def\um{{\bf u}}

\def\td{\widetilde{d}}
\def\tD{\widetilde{D}}
\def\porth{{\sf P}^{\perp}}
\def\id{{\bf I}}
\def\one{{\bf 1}}
\def\b0{{\bf 0}}
\def\Rperp{R^{\perp}}
\def\supp{{\rm supp}}
\def\Tr{{\rm Tr}}
\def\cS{{\cal S}}
\def\cX{{\cal X}}
\def\cC{{\cal C}}
\def\Cost{{\cal C}}
\def\String{{\sf S}}
\def\Poly{{\rm Poly}}

\def\uS{\underline{S}}
\def\uc{\underline{c}}
\def\hZ{\widehat{Z}}
\def\cut{{\rm cut}}
\def\tol{\leftarrow}
\def\normal{{\rm N}}
\def\root{{o}}

\def\meas{{\sf M}}
\def\vE{{\vec{E}}}
\def\F{{\sf F}}
\def\Fv{{\sf F^v}}
\def\hT{\widehat{T}}
\def\cE{{\cal E}}
\def\Tmix{T_{\rm mix}}
\def\ones{\mathds 1}
\def\dBall{\partial{\sf B}}
\def\SAW{\mbox{\tiny SAW}}
\def\pe{P_{\rm error}}
\def\tnu{\tilde{\nu}}
\def\cind{\perp\!\!\!\perp}

\begin{document}
    \section*{Problem Reduction}
    \subsection*{Initial Problem}
    \begin{align*}
        &\mathrm{min}_{\theta, \alpha_{A}, \alpha_{P}, \{\beta_i \}, \{\beta_j^\prime \}} \alpha_A r_A + \alpha_P r_P + \frac{1}{n_A} \sum_{i \in [n_\alpha]} \beta_i + \frac{1}{n_P} \sum_{j \in [n_P]} \beta_j^\prime
        \\ &\text{s.t. } \mathrm{max}_{y\in \{\pm 1\} } \mathrm{sup}_{(x, a)} \ell(\theta,(x,a,y))-\alpha_{A}d_{A}^{i}(x,a)-\alpha_{P} d_{P}^{j}(x,y) \le \beta_i + \beta_j^\prime &&\forall i, j
    \end{align*}
    \subsection*{Constraint Reduction}
    \begin{enumerate}
        \item Focus on the constraint because there is a sup term that makes it hard to optimize (analyze $y=+1$ for simplicity)
        \begin{align*}
            \mathrm{sup}_{(x, a)} \ell(\theta,(x,a,y))-\alpha_{A}d_{A}^{i}(x,a)-\alpha_{P} d_{P}^{j}(x,y)
        \end{align*}
        \item Focus on the term depending on $(x, a)$ and ignoring dependence on $y$
        \begin{align*}
            = \kappa_{P}\alpha_{P} | y_{j}^{P}-y | + \left(\operatorname*{sup}_{(x, a)} h(y\theta,(x,a))-\alpha_{A}\vert\vert x_{i}^{A}-x\vert\vert_{p}-\alpha_{P}\vert\vert x_{j}^{P}-x\vert\vert_{p}-\alpha_{A} \kappa_A \vert\vert a_{i}^{A}-a\vert\vert_{p^{\prime}}\right)
        \end{align*}
        \item Upperbound the new sup term inside
        \begin{align*}
            &\operatorname*{sup}_{(x, a)} h(y\theta,(x,a))-\alpha_{A}\vert\vert x_{i}^{A}-x\vert\vert_{p}-\alpha_{P}\vert\vert x_{j}^{P}-x\vert\vert_{p}-\alpha_{A} \kappa_A \vert\vert a_{i}^{A}-a\vert\vert_{p^{\prime}}
            \\ &\le f\Biggl(\frac{\mathrm{min}(\alpha_{A},\alpha_P)||\theta_{1}||_* ||x_{i}^{A}-x_{j}^{P}||}{\alpha_{A}+\alpha_{P}}+\frac{\langle y\theta_{1},\alpha_{A}x_{i}^{A}+\alpha_P x_{j}^{P}\rangle}{\alpha_{A}+\alpha_{P}}+\langle y\theta_{2},a_{i}^{A}\rangle\Biggr) - \mathrm{min}(\alpha_A, \alpha_P) ||x_i^A - x_j^P ||_p
        \end{align*}
        required 
        \begin{align*}
            ||\theta_1||_{p, *} \le \alpha_A + \alpha_P \ and \ ||\theta_2||_{p', *} \le \kappa_A \alpha_A
        \end{align*}
        Otherwise, the sup term evaluates to $\infty$. \textit{They also showed the gap is not signifiant}

        \item They also showed an approximation upperbound with $f(\langle y \theta_{1},(\hat{x}_{i,j},a_{i}^{A}) \rangle )$
        \begin{align*}
            \hat{x}_{i, j} = \begin{cases} x_j^P &\text{if } \alpha_A < \alpha_P \\ x_i^A \end{cases}
        \end{align*}
        \begin{align*}
            f\Biggl(\frac{\mathrm{min}(\alpha_{A},\alpha_P)||\theta_{1}||_* ||x_{i}^{A}-x_{j}^{P}||}{\alpha_{A}+\alpha_{P}}+\frac{\langle y\theta_{1},\alpha_{A}x_{i}^{A}+\alpha_P x_{j}^{P}\rangle}{\alpha_{A}+\alpha_{P}}+\langle y\theta_{2},a_{i}^{A}\rangle\Biggr) - f(\langle y \theta_{1},(\hat{x}_{i,j},a_{i}^{A}) \rangle ) \le 2 \hat{\alpha} ||x_i^{A} - x_j^{P}||
        \end{align*}

        \item Use the bounds
        \begin{align*}
            &\left(\mathrm{max}_{y\in \{\pm 1\} } \mathrm{sup}_{(x, a)} \ell(\theta,(x,a,y))-\alpha_{A}d_{A}^{i}(x,a)-\alpha_{P} d_{P}^{j}(x,y)\right) + \left( \hat{\alpha} ||x_i^A - x_j^P||_p \right)
            \\ &- f(\langle y_j^P \theta, (\hat{x}_{i,j}, a_i^A) \rangle) - \text{max}(y_j^P \langle \theta, (\hat{x}_{i,j}, a_i^A) \rangle - \alpha_P \kappa_P, 0) \le 2 \hat{\alpha} ||x_i^A - x_j^P||_p
        \end{align*}
        
        \item To formulate it better to replace the max/sup term
        \begin{align*}
            &\left(\mathrm{max}_{y\in \{\pm 1\} } \mathrm{sup}_{(x, a)} \ell(\theta,(x,a,y))-\alpha_{A}d_{A}^{i}(x,a)-\alpha_{P} d_{P}^{j}(x,y)\right)
            \\ &\le \left( f(\langle y_j^P \theta, (\hat{x}_{i,j}, a_i^A) \rangle) + \text{max}(y_j^P \langle \theta, (\hat{x}_{i,j}, a_i^A) \rangle - \alpha_P \kappa_P, 0) - \hat{\alpha} ||x_i^A - x_j^P||_p \right) - 2 \hat{\alpha} ||x_i^A - x_j^P||_p
        \end{align*}

        \item We can replace the max/sup term and re-formulate the problem
        \begin{align*}
            &\mathrm{min}_{\theta, \alpha_{A}, \alpha_{P}, \{\beta_i \}, \{\beta_j^\prime \}} \alpha_A r_A + \alpha_P r_P + \frac{1}{n_A} \sum_{i \in [n_\alpha]} \beta_i + \frac{1}{n_P} \sum_{j \in [n_P]} \beta_j^\prime
            \\ &\text{s.t. } \left( f(\langle y_j^P \theta, (\hat{x}_{i,j}, a_i^A) \rangle) + \text{max}(y_j^P \langle \theta, (\hat{x}_{i,j}, a_i^A) \rangle - \alpha_P \kappa_P, 0) - \hat{\alpha} ||x_i^A - x_j^P||_p \right) \le \beta_i + \beta_j^\prime &&\forall i, j
        \end{align*}
    \end{enumerate}
    \subsection*{Optimization on Reduced Problem}
    \begin{enumerate}
        \item Approximation bounds reduces to solve this problem
        \begin{align*}
            \operatorname*{min}_{\alpha_{A}\alpha_{P}\theta_{1}\theta_{2}}(\alpha_{A}r_{A}+\alpha_{P}r_{P})+\frac{1}{n_{A}n_{P}}\sum_{(i,j) \in M}(f(y_{j}^P\langle \theta , (\hat{x}_{i, j}, a_i^A)\rangle)+\mathrm{max}(y_{j}^{P}\langle \theta, \hat{x}_{i, j},a_{i}^{A} \rangle -\alpha_{P}\kappa_{P},0)-\hat{\alpha}||x_{i}^{A}-x_{j}^{P}||)
        \end{align*}
        s.t. $||\theta_1||_* \le \alpha_A + \alpha_P, ||\theta_2||_* \le \kappa_A \alpha_A$
        \item Projected gradient descent on both cases $\alpha_A < \alpha_P$ and the other way around
        When $\alpha_A < \alpha_P$, $\hat{x}_{i, j} = x_j^P$ and $\hat{\alpha} = \alpha_A$
        \begin{align*}
            &\Omega^A(\alpha_A, \alpha_P, \theta) 
            \\ &= \operatorname*{min}_{\alpha_{A}\alpha_{P}\theta_{1}\theta_{2}}(\alpha_{A}r_{A}+\alpha_{P}r_{P})+\frac{1}{n_{A}n_{P}}\sum_{(i,j) \in M}(f(y_{j}^P\langle \theta , (x_j^P, a_i^A)\rangle)+\mathrm{max}(y_{j}^{P}\langle \theta, (x_j^P,a_{i}^{A}) \rangle -\alpha_{P}\kappa_{P},0)-\alpha_A||x_{i}^{A}-x_{j}^{P}||)
        \end{align*}
        \item The paper derives projected gradient descent
        \begin{align*}
            ||\theta_1||_* &\le \alpha_A + \alpha_P
            \\ ||\theta_2||_* &\le \kappa_A \alpha_A
            \\ \alpha_A \le \alpha_P &\text{ or } \alpha_P \le \alpha_A
        \end{align*}
        \item The projection is solved by a Lagrangian
    \end{enumerate}
    \subsection*{Constrained Optimization}
    \begin{enumerate}
        \item Lagrangian
        \item Projected Gradient Descent (In the paper)
        \item Reparameterization
    \end{enumerate}
\end{document}